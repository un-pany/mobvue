import{r as y,t as K,y as re,w as P,g as _,m as u,X as H,Y as V,U as G,Z,A as T,f as ue,o as q,q as de,F as fe,p as ve,u as me,l as ye,Q as he,n as Ce,j as Oe}from"./vue-_7-lypa3.js";import{t as b,f as L,n as g,a1 as j,Y as ke,a2 as we,p as W,c as D,A as Q,y as z,a3 as ge,i as N,w as R,a4 as Ie,m as S,a5 as be,W as Se,I as J,a6 as Pe,P as xe,V as pe,L as Te,j as ze,o as Be}from"./index-Bo60SuVm.js";import{u as ee}from"./use-expose--G23VKW6.js";import{u as $}from"./index-caqC4QdK.js";const Ae={show:Boolean,zIndex:g,overlay:b,duration:g,teleport:[String,Object],lockScroll:b,lazyRender:b,beforeClose:Function,overlayStyle:Object,overlayClass:L,transitionAppear:Boolean,closeOnClickOverlay:b};function Le(e,t){return e>t?"horizontal":t>e?"vertical":""}function Ee(){const e=y(0),t=y(0),o=y(0),s=y(0),n=y(0),l=y(0),c=y(""),a=y(!0),d=()=>c.value==="vertical",k=()=>c.value==="horizontal",v=()=>{o.value=0,s.value=0,n.value=0,l.value=0,c.value="",a.value=!0};return{move:m=>{const h=m.touches[0];o.value=(h.clientX<0?0:h.clientX)-e.value,s.value=h.clientY-t.value,n.value=Math.abs(o.value),l.value=Math.abs(s.value);const C=10;(!c.value||n.value<C&&l.value<C)&&(c.value=Le(n.value,l.value)),a.value&&(n.value>j||l.value>j)&&(a.value=!1)},start:m=>{v(),e.value=m.touches[0].clientX,t.value=m.touches[0].clientY},reset:v,startX:e,startY:t,deltaX:o,deltaY:s,offsetX:n,offsetY:l,direction:c,isVertical:d,isHorizontal:k,isTap:a}}let x=0;const U="van-overflow-hidden";function _e(e,t){const o=Ee(),s="01",n="10",l=v=>{o.move(v);const i=o.deltaY.value>0?n:s,f=we(v.target,e.value),{scrollHeight:m,offsetHeight:h,scrollTop:C}=f;let O="11";C===0?O=h>=m?"00":"01":C+h>=m&&(O="10"),O!=="11"&&o.isVertical()&&!(parseInt(O,2)&parseInt(i,2))&&W(v,!0)},c=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",l,{passive:!1}),x||document.body.classList.add(U),x++},a=()=>{x&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",l),x--,x||document.body.classList.remove(U))},d=()=>t()&&c(),k=()=>t()&&a();ke(d),K(k),re(k),P(t,v=>{v?c():a()})}function te(e){const t=y(!1);return P(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const[De,Ne]=D("overlay"),Re={show:Boolean,zIndex:g,duration:g,className:L,lockScroll:b,lazyRender:b,customStyle:Object,teleport:[String,Object]};var Me=_({name:De,inheritAttrs:!1,props:Re,setup(e,{attrs:t,slots:o}){const s=y(),n=te(()=>e.show||!e.lazyRender),l=a=>{e.lockScroll&&W(a,!0)},c=n(()=>{var a;const d=z(ge(e.zIndex),e.customStyle);return N(e.duration)&&(d.animationDuration="".concat(e.duration,"s")),G(u("div",T({ref:s,style:d,class:[Ne(),e.className]},t),[(a=o.default)==null?void 0:a.call(o)]),[[Z,e.show]])});return Q("touchmove",l,{target:s}),()=>{const a=u(H,{name:"van-fade",appear:!0},{default:c});return e.teleport?u(V,{to:e.teleport},{default:()=>[a]}):a}}});const Ye=R(Me),je=z({},Ae,{round:Boolean,position:S("center"),closeIcon:S("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:S("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[$e,X]=D("popup");var Ue=_({name:$e,inheritAttrs:!1,props:je,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:s}){let n,l;const c=y(),a=y(),d=te(()=>e.show||!e.lazyRender),k=ue(()=>{const r={zIndex:c.value};if(N(e.duration)){const w=e.position==="center"?"animationDuration":"transitionDuration";r[w]="".concat(e.duration,"s")}return r}),v=()=>{n||(n=!0,c.value=e.zIndex!==void 0?+e.zIndex:Ie(),t("open"))},i=()=>{n&&be(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},f=r=>{t("clickOverlay",r),e.closeOnClickOverlay&&i()},m=()=>{if(e.overlay)return u(Ye,T({show:e.show,class:e.overlayClass,zIndex:c.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},$(),{onClick:f}),{default:s["overlay-content"]})},h=r=>{t("clickCloseIcon",r),i()},C=()=>{if(e.closeable)return u(J,{role:"button",tabindex:0,name:e.closeIcon,class:[X("close-icon",e.closeIconPosition),Se],classPrefix:e.iconPrefix,onClick:h},null)};let O;const ne=()=>{O&&clearTimeout(O),O=setTimeout(()=>{t("opened")})},ae=()=>t("closed"),se=r=>t("keydown",r),le=d(()=>{var r;const{destroyOnClose:w,round:E,position:B,safeAreaInsetTop:ce,safeAreaInsetBottom:ie,show:Y}=e;if(!(!Y&&w))return G(u("div",T({ref:a,style:k.value,role:"dialog",tabindex:0,class:[X({round:E,[B]:B}),{"van-safe-area-top":ce,"van-safe-area-bottom":ie}],onKeydown:se},o,$()),[(r=s.default)==null?void 0:r.call(s),C()]),[[Z,Y]])}),M=()=>{const{position:r,transition:w,transitionAppear:E}=e,B=r==="center"?"van-fade":"van-popup-slide-".concat(r);return u(H,{name:w||B,appear:E,onAfterEnter:ne,onAfterLeave:ae},{default:le})};return P(()=>e.show,r=>{r&&!n&&(v(),o.tabindex===0&&ve(()=>{var w;(w=a.value)==null||w.focus()})),!r&&n&&(n=!1,t("close"))}),ee({popupRef:a}),_e(a,()=>e.show&&e.lockScroll),Q("popstate",()=>{e.closeOnPopstate&&(i(),l=!1)}),q(()=>{e.show&&v()}),de(()=>{l&&(t("update:show",!0),l=!1)}),K(()=>{e.show&&e.teleport&&(i(),l=!0)}),me(Pe,()=>e.show),()=>e.teleport?u(V,{to:e.teleport},{default:()=>[m(),M()]}):u(fe,null,[m(),M()])}});const Xe=R(Ue);let p=0;function Fe(e){e?(p||document.body.classList.add("van-toast--unclickable"),p++):p&&(p--,p||document.body.classList.remove("van-toast--unclickable"))}const[Ke,I]=D("toast"),He=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],Ve={icon:String,show:Boolean,type:S("text"),overlay:Boolean,message:g,iconSize:g,duration:xe(2e3),position:S("middle"),teleport:[String,Object],wordBreak:String,className:L,iconPrefix:String,transition:S("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:L,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:g};var oe=_({name:Ke,props:Ve,emits:["update:show"],setup(e,{emit:t,slots:o}){let s,n=!1;const l=()=>{const i=e.show&&e.forbidClick;n!==i&&(n=i,Fe(n))},c=i=>t("update:show",i),a=()=>{e.closeOnClick&&c(!1)},d=()=>clearTimeout(s),k=()=>{const{icon:i,type:f,iconSize:m,iconPrefix:h,loadingType:C}=e;if(i||f==="success"||f==="fail")return u(J,{name:i||f,size:m,class:I("icon"),classPrefix:h},null);if(f==="loading")return u(Te,{class:I("loading"),size:m,type:C},null)},v=()=>{const{type:i,message:f}=e;if(o.message)return u("div",{class:I("text")},[o.message()]);if(N(f)&&f!=="")return i==="html"?u("div",{key:0,class:I("text"),innerHTML:String(f)},null):u("div",{class:I("text")},[f])};return P(()=>[e.show,e.forbidClick],l),P(()=>[e.show,e.type,e.message,e.duration],()=>{d(),e.show&&e.duration>0&&(s=setTimeout(()=>{c(!1)},e.duration))}),q(l),ye(l),()=>u(Xe,T({class:[I([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:a,onClosed:d,"onUpdate:show":c},pe(e,He)),{default:()=>[k(),v()]})}});function Ge(){const e=Ce({show:!1}),t=n=>{e.show=n},o=n=>{z(e,n,{transitionAppear:!0}),t(!0)},s=()=>t(!1);return ee({open:o,close:s,toggle:t}),{open:o,close:s,state:e,toggle:t}}function Ze(e){const t=he(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}const qe={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let A=[],We=!1,F=z({},qe);const Qe=new Map;function Je(e){return Be(e)?e:{message:e}}function et(){const{instance:e}=Ze({setup(){const t=y(""),{open:o,state:s,close:n,toggle:l}=Ge(),c=()=>{},a=()=>u(oe,T(s,{onClosed:c,"onUpdate:show":l}),null);return P(t,d=>{s.message=d}),Oe().render=a,{open:o,close:n,message:t}}});return e}function tt(){if(!A.length||We){const e=et();A.push(e)}return A[A.length-1]}function lt(e={}){if(!ze)return{};const t=tt(),o=Je(e);return t.open(z({},F,Qe.get(o.type||F.type),o)),t}R(oe);export{Xe as P,lt as s};
